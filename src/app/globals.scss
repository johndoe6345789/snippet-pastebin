@use '../styles/abstracts' as *;
@use '../styles/utilities/utilities';
@use '../styles/components';
@use './theme';

// Global resets
/* stylelint-disable selector-max-universal */
* {
  border-color: $border;
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

*,
::after,
::before,
::backdrop,
::file-selector-button {
  border-color: var(--md3-outline-variant);
}
/* stylelint-enable selector-max-universal */

// Body and base styles - Android Material You feel
body {
  background: $background;
  color: $foreground;
  font-family: var(--font-inter), Inter, Roboto, system-ui, sans-serif;
  font-size: $font-body-medium;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  letter-spacing: $letter-spacing-body;
  line-height: $line-height-body-medium;
  overflow-x: hidden;
  transition: background-color $duration-medium-2 $easing-standard,
              color $duration-medium-2 $easing-standard;
}

// ============================================
// MD3 Typography Classes
// ============================================

// Display styles
.md3-display-large {
  font-size: $font-display-large;
  font-weight: 400;
  letter-spacing: $letter-spacing-display;
  line-height: $line-height-display-large;
}

.md3-display-medium {
  font-size: $font-display-medium;
  font-weight: 400;
  letter-spacing: $letter-spacing-display;
  line-height: $line-height-display-medium;
}

.md3-display-small {
  font-size: $font-display-small;
  font-weight: 400;
  letter-spacing: $letter-spacing-display;
  line-height: $line-height-display-small;
}

// Headline styles
.md3-headline-large {
  font-size: $font-headline-large;
  font-weight: 400;
  letter-spacing: $letter-spacing-headline;
  line-height: $line-height-headline-large;
}

.md3-headline-medium {
  font-size: $font-headline-medium;
  font-weight: 400;
  letter-spacing: $letter-spacing-headline;
  line-height: $line-height-headline-medium;
}

.md3-headline-small {
  font-size: $font-headline-small;
  font-weight: 400;
  letter-spacing: $letter-spacing-headline;
  line-height: $line-height-headline-small;
}

// Title styles
.md3-title-large {
  font-size: $font-title-large;
  font-weight: 400;
  letter-spacing: $letter-spacing-title;
  line-height: $line-height-title-large;
}

.md3-title-medium {
  font-size: $font-title-medium;
  font-weight: 500;
  letter-spacing: $letter-spacing-title;
  line-height: $line-height-title-medium;
}

.md3-title-small {
  font-size: $font-title-small;
  font-weight: 500;
  letter-spacing: $letter-spacing-title;
  line-height: $line-height-title-small;
}

// Body styles
.md3-body-large {
  font-size: $font-body-large;
  font-weight: 400;
  letter-spacing: $letter-spacing-body;
  line-height: $line-height-body-large;
}

.md3-body-medium {
  font-size: $font-body-medium;
  font-weight: 400;
  letter-spacing: $letter-spacing-body;
  line-height: $line-height-body-medium;
}

.md3-body-small {
  font-size: $font-body-small;
  font-weight: 400;
  letter-spacing: $letter-spacing-body;
  line-height: $line-height-body-small;
}

// Label styles
.md3-label-large {
  font-size: $font-label-large;
  font-weight: 500;
  letter-spacing: $letter-spacing-label;
  line-height: $line-height-label-large;
}

.md3-label-medium {
  font-size: $font-label-medium;
  font-weight: 500;
  letter-spacing: $letter-spacing-label;
  line-height: $line-height-label-medium;
}

.md3-label-small {
  font-size: $font-label-small;
  font-weight: 500;
  letter-spacing: $letter-spacing-label;
  line-height: $line-height-label-small;
}

// Typography base for headings
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-inter), Inter, Roboto, system-ui, sans-serif;
  font-weight: 400;
  letter-spacing: $letter-spacing-headline;
}

h1 {
  font-size: $font-headline-large;
  line-height: $line-height-headline-large;
}

h2 {
  font-size: $font-headline-medium;
  line-height: $line-height-headline-medium;
}

h3 {
  font-size: $font-headline-small;
  line-height: $line-height-headline-small;
}

h4 {
  font-size: $font-title-large;
  line-height: $line-height-title-large;
}

h5 {
  font-size: $font-title-medium;
  font-weight: 500;
  line-height: $line-height-title-medium;
}

h6 {
  font-size: $font-title-small;
  font-weight: 500;
  line-height: $line-height-title-small;
}

code, pre {
  font-family: var(--font-jetbrains-mono), 'JetBrains Mono', 'Roboto Mono', monospace;
}

// ============================================
// MD3 CSS Custom Properties (Dark Theme)
// ============================================
:root {
  // Primary
  --md3-primary: #{$primary};
  --md3-on-primary: #{$on-primary};
  --md3-primary-container: #{$primary-container};
  --md3-on-primary-container: #{$on-primary-container};

  // Secondary
  --md3-secondary: #{$secondary};
  --md3-on-secondary: #{$on-secondary};
  --md3-secondary-container: #{$secondary-container};
  --md3-on-secondary-container: #{$on-secondary-container};

  // Tertiary
  --md3-tertiary: #{$accent};
  --md3-on-tertiary: #{$on-tertiary};
  --md3-tertiary-container: #{$tertiary-container};
  --md3-on-tertiary-container: #{$on-tertiary-container};

  // Error
  --md3-error: #{$destructive};
  --md3-on-error: #{$on-error};
  --md3-error-container: #{$error-container};
  --md3-on-error-container: #{$on-error-container};

  // Surface
  --md3-surface: #{$surface};
  --md3-on-surface: #{$on-surface};
  --md3-surface-variant: #{$surface-variant};
  --md3-on-surface-variant: #{$on-surface-variant};
  --md3-surface-dim: #{$surface-dim};
  --md3-surface-bright: #{$surface-bright};

  // Surface Containers (MD3 tonal elevation)
  --md3-surface-container-lowest: #{$surface-container-lowest};
  --md3-surface-container-low: #{$surface-container-low};
  --md3-surface-container: #{$surface-container};
  --md3-surface-container-high: #{$surface-container-high};
  --md3-surface-container-highest: #{$surface-container-highest};

  // Background
  --md3-background: #{$background};
  --md3-on-background: #{$on-background};

  // Outline
  --md3-outline: #{$outline};
  --md3-outline-variant: #{$outline-variant};

  // Inverse
  --md3-inverse-surface: #{$inverse-surface};
  --md3-inverse-on-surface: #{$inverse-on-surface};
  --md3-inverse-primary: #{$inverse-primary};

  // Scrim & Shadow
  --md3-scrim: #{$scrim};
  --md3-shadow: #{$shadow};

  // Semantic colors
  --md3-success: #{$md3-success-80};
  --md3-on-success: #{$md3-success-40};
  --md3-warning: #{$md3-warning-80};
  --md3-on-warning: #{$md3-warning-40};
  --md3-info: #{$md3-info-80};
  --md3-on-info: #{$md3-info-40};

  // State layers
  --md3-state-hover: #{$state-hover-opacity};
  --md3-state-focus: #{$state-focus-opacity};
  --md3-state-pressed: #{$state-pressed-opacity};
  --md3-state-dragged: #{$state-dragged-opacity};
  --md3-state-disabled: #{$state-disabled-opacity};

  // Elevation
  --md3-elevation-1: #{$elevation-1};
  --md3-elevation-2: #{$elevation-2};
  --md3-elevation-3: #{$elevation-3};
  --md3-elevation-4: #{$elevation-4};
  --md3-elevation-5: #{$elevation-5};

  // Motion
  --md3-duration-short: #{$duration-short-4};
  --md3-duration-medium: #{$duration-medium-2};
  --md3-duration-long: #{$duration-long-2};
  --md3-easing-standard: #{$easing-standard};
  --md3-easing-emphasized: #{$easing-emphasized};
  --md3-easing-emphasized-decelerate: #{$easing-emphasized-decelerate};

  // Shape
  --md3-shape-extra-small: #{$radius-extra-small};
  --md3-shape-small: #{$radius-small};
  --md3-shape-medium: #{$radius-medium};
  --md3-shape-large: #{$radius-large};
  --md3-shape-extra-large: #{$radius-extra-large};
  --md3-shape-full: #{$radius-full};

  // Legacy compatibility
  --background: 260 10% 6%;
  --foreground: 260 10% 90%;
  --card: 260 10% 10%;
  --card-foreground: 260 10% 90%;
  --popover: 260 10% 17%;
  --popover-foreground: 260 10% 90%;
  --primary: 260 50% 80%;
  --primary-foreground: 260 50% 20%;
  --secondary: 260 15% 80%;
  --secondary-foreground: 260 15% 20%;
  --muted: 260 10% 12%;
  --muted-foreground: 260 15% 80%;
  --accent: 180 50% 80%;
  --accent-foreground: 180 50% 20%;
  --destructive: 0 75% 80%;
  --destructive-foreground: 0 75% 20%;
  --border: 260 15% 30%;
  --input: 260 10% 22%;
  --ring: 260 50% 80%;
  --radius: 0.75rem;

  // Chart colors (MD3 inspired)
  --chart-1: #{$md3-primary-60};
  --chart-2: #{$md3-secondary-60};
  --chart-3: #{$md3-tertiary-60};
  --chart-4: #{$md3-error-60};
  --chart-5: #{$md3-warning-80};

  // Sidebar colors (MD3)
  --sidebar: 260 10% 10%;
  --sidebar-foreground: 260 10% 90%;
  --sidebar-primary: 260 50% 80%;
  --sidebar-primary-foreground: 260 50% 20%;
  --sidebar-accent: 260 10% 17%;
  --sidebar-accent-foreground: 260 10% 90%;
  --sidebar-border: 260 15% 30%;
  --sidebar-ring: 260 50% 80%;
}

// ============================================
// MD3 Surface Utility Classes
// ============================================

.md3-surface {
  background-color: var(--md3-surface);
  color: var(--md3-on-surface);
}

.md3-surface-dim {
  background-color: var(--md3-surface-dim);
  color: var(--md3-on-surface);
}

.md3-surface-bright {
  background-color: var(--md3-surface-bright);
  color: var(--md3-on-surface);
}

.md3-surface-container-lowest {
  background-color: var(--md3-surface-container-lowest);
  color: var(--md3-on-surface);
}

.md3-surface-container-low {
  background-color: var(--md3-surface-container-low);
  color: var(--md3-on-surface);
}

.md3-surface-container {
  background-color: var(--md3-surface-container);
  color: var(--md3-on-surface);
}

.md3-surface-container-high {
  background-color: var(--md3-surface-container-high);
  color: var(--md3-on-surface);
}

.md3-surface-container-highest {
  background-color: var(--md3-surface-container-highest);
  color: var(--md3-on-surface);
}

// ============================================
// MD3 Elevation Classes
// ============================================

.md3-elevation-1 {
  box-shadow: var(--md3-elevation-1);
}

.md3-elevation-2 {
  box-shadow: var(--md3-elevation-2);
}

.md3-elevation-3 {
  box-shadow: var(--md3-elevation-3);
}

.md3-elevation-4 {
  box-shadow: var(--md3-elevation-4);
}

.md3-elevation-5 {
  box-shadow: var(--md3-elevation-5);
}

// ============================================
// MD3 State Layer Mixin Classes
// ============================================

.md3-state-layer {
  overflow: hidden;
  position: relative;

  &::before {
    background-color: currentcolor;
    border-radius: inherit;
    content: '';
    inset: 0;
    opacity: 0%;
    pointer-events: none;
    position: absolute;
    transition: opacity $duration-short-4 $easing-standard;
  }

  &:hover::before {
    opacity: var(--md3-state-hover);
  }

  &:focus-visible::before {
    opacity: var(--md3-state-focus);
  }

  &:active::before {
    opacity: var(--md3-state-pressed);
  }
}

// ============================================
// MD3 Ripple Effect
// ============================================

@keyframes md3-ripple {
  from {
    opacity: 12%;
    transform: scale(0);
  }

  to {
    opacity: 0%;
    transform: scale(4);
  }
}

.md3-ripple {
  overflow: hidden;
  position: relative;

  &::after {
    background: radial-gradient(circle, currentcolor 10%, transparent 10.01%);
    border-radius: 50%;
    content: '';
    height: 100%;
    left: 50%;
    opacity: 0%;
    pointer-events: none;
    position: absolute;
    top: 50%;
    transform: translate(-50%, -50%) scale(0);
    width: 100%;
  }

  &:active::after {
    animation: md3-ripple $duration-medium-4 $easing-standard;
  }
}

// ============================================
// Animations (MD3 Motion)
// ============================================

@keyframes accordion-down {
  from {
    height: 0;
    opacity: 0%;
  }

  to {
    height: var(--radix-accordion-content-height);
    opacity: 100%;
  }
}

@keyframes accordion-up {
  from {
    height: var(--radix-accordion-content-height);
    opacity: 100%;
  }

  to {
    height: 0;
    opacity: 0%;
  }
}

@keyframes md3-fade-in {
  from {
    opacity: 0%;
  }

  to {
    opacity: 100%;
  }
}

@keyframes md3-fade-out {
  from {
    opacity: 100%;
  }

  to {
    opacity: 0%;
  }
}

@keyframes md3-scale-in {
  from {
    opacity: 0%;
    transform: scale(0.8);
  }

  to {
    opacity: 100%;
    transform: scale(1);
  }
}

@keyframes md3-slide-in-bottom {
  from {
    opacity: 0%;
    transform: translateY(100%);
  }

  to {
    opacity: 100%;
    transform: translateY(0);
  }
}

@keyframes md3-slide-in-right {
  from {
    opacity: 0%;
    transform: translateX(100%);
  }

  to {
    opacity: 100%;
    transform: translateX(0);
  }
}

// ============================================
// Android-style System UI
// ============================================

// Status bar simulation (optional)
.android-status-bar {
  align-items: center;
  background: var(--md3-surface-container-lowest);
  color: var(--md3-on-surface);
  display: flex;
  font-size: $font-label-small;
  height: 24px;
  justify-content: flex-end;
  padding: 0 $size-4;
}

// Navigation bar simulation (bottom gesture bar)
.android-nav-bar {
  align-items: center;
  background: transparent;
  display: flex;
  height: 20px;
  justify-content: center;
  padding-bottom: $size-2;

  &::after {
    background: var(--md3-on-surface-variant);
    border-radius: $radius-full;
    content: '';
    height: 5px;
    opacity: 40%;
    width: 134px;
  }
}

// Selection styling
::selection {
  background: rgba($primary, 0.3);
  color: $on-surface;
}

// Scrollbar styling (Android-like thin scrollbar)
::-webkit-scrollbar {
  height: 4px;
  width: 4px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: var(--md3-outline-variant);
  border-radius: $radius-full;

  &:hover {
    background: var(--md3-outline);
  }
}

// Focus visible styling (MD3 style)
:focus-visible {
  outline: 2px solid var(--md3-primary);
  outline-offset: 2px;
}
